{% extends 'base.html' %}

{% block content %}
<div class="container mt-4" style="padding: 0;">
    <div class="mx-auto" style="max-width: 1200px; margin-left: 0;">
        <!-- Заголовок поста -->
        <h1 class="mb-2">{{ post.title }}</h1>
        
        <!-- Информация об авторе и дате -->
        <div class="text-muted mb-4">
            {{ post.author }}, {{ post.date.strftime('%d.%m.%Y') }}
        </div>
        
        <!-- Изображение поста -->
        <div class="mb-4 d-flex justify-content-center">
            <img src="{{ url_for('static', filename='images/' + post.image_id) }}" 
                 style="width: 100%; max-width: 800px;"
                 alt="Изображение к посту">
        </div>
        
        <!-- Текст поста -->
        <div class="mb-5">
            {{ post.text }}
        </div>
        
        <!-- Форма для комментариев -->
        <div class="mb-5">
            <h4>Оставьте комментарий</h4>
            <div class="mt-3">
                <textarea class="form-control mb-3" 
                          rows="3" 
                          placeholder="Введите ваш комментарий"></textarea>
                <button type="submit" class="btn btn-primary">Отправить</button>
            </div>
        </div>

        <!-- Секция комментариев -->
        <div class="comments">
            <h4 class="mb-4">Комментарии</h4>
            {% for comment in post.comments %}
            <div class="d-flex mb-4">
                <div class="flex-shrink-0">
                    <div class="rounded-circle bg-secondary text-white d-flex align-items-center justify-content-center" 
                         style="width: 48px; height: 48px;">
                        {{ comment.author[0] }}
                    </div>
                </div>
                <div class="flex-grow-1 ms-3">
                    <h5>
                        {{ comment.author }} 
                        <small class="text-muted">
                            <i>{{ comment.date.strftime('%d.%m.%Y') if comment.date else '' }}</i>
                        </small>
                    </h5>
                    <p>{{ comment.text }}</p>
                    
                    <!-- Ответы на комментарий -->
                    {% if comment.replies %}
                    {% for reply in comment.replies %}
                    <div class="d-flex mt-4">
                        <div class="flex-shrink-0">
                            <div class="rounded-circle bg-secondary text-white d-flex align-items-center justify-content-center" 
                                 style="width: 40px; height: 40px;">
                                {{ reply.author[0] }}
                            </div>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <h5>
                                {{ reply.author }}
                                <small class="text-muted">
                                    <i>{{ reply.date.strftime('%d.%m.%Y') if reply.date else '' }}</i>
                                </small>
                            </h5>
                            <p>{{ reply.text }}</p>
                        </div>
                    </div>
                    {% endfor %}
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div> 
    </div>
</div>
{% endblock %} 